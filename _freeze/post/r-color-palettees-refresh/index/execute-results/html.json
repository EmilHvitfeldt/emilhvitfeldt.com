{
  "hash": "d1a69ea08aa2c3c525bcb37b483f354d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'R Color Palettes Refresh'\ndescription: |\n  Total rewrite of R Color Palettes and new release of paletteer.\ndate: '2026-01-30'\ncategories:\n - color palettes\nimage: \"featured.webp\"\n---\n\nIn this post, I will go over how I did a refresh on my repository of [Comprehensive list of color palettes in R](https://github.com/EmilHvitfeldt/r-color-palettes).\n\nThis project has seemingly been useful for a lot of people,\nas it shows all the palettes from the [paletteer](https://github.com/EmilHvitfeldt/paletteer) package.\nHowever, due to the way I had it set up,\nit has been slowly going out of sync with what was available in paletter due to its very manual construction.\nThis post goes over the new designs and how I made this repository future-proof.\n\n## New plotting function\n\nWhat I imagine is that one of the main draws of the repository is all the visual representations of all the palettes.\nAs a reminder, they looked something like this:\n\n![](awtools-before.webp)\n\nWhile they look perfectly fine, there were a couple of things I was not perfectly happy with.\nThe images appeared blurry because of the compression I was using.\nIt didn't contain any information about the colors themselves, \nso users would need to use a color picker to easily extract colors from the readme.\nI originally took the approach of prioritising that the palette stretched and took up the whole width.\nAnd while that looks very nice, it makes it hard at a glance to see how many colors were in any given palette.\nLastly, because of my lack of skills at the time,\nI wasn't able to get the dimensions right of the images produced, and I would thus get varying distances between the palette name and the palettes in the pictures.\nAs seen below, the ggsci palette has a much larger gap than the awtools we saw earlier.\n\n![](ggsci-before.webp)\n\nThrough the years, I have been many ways to display color palettes, and I became quite fond of how it was done in the [{ltc} palette readme](https://github.com/loukesio/ltc-color-palettes).\nAnd I have taken a lot of inspiration from them in how I adapted my new plotter.\n\nThe [code I wrote](https://github.com/EmilHvitfeldt/r-color-palettes/blob/main/palette_plotter.R) isn't terribly exciting as a whole,\nBut I will show some of the important points here.\n\nI structured the code into 2 main parts.\nThe first part takes a list of color palettes and generates data frames for what we need.\nThis includes polygons (squares and rectangles) for the colors,\nhexcodes, and titles with associated locations.\nThe second part is a {ggplot2} call that makes the whole thing happen.\n\nAll of the calculations have their origin in the following variables I set at the top.\n\n```r\nsize <- 100\ngap <- 5\ncol_gap <- 100\n```\n\n`size` is the default height of all palettes,\n`gag` is the general horizontal spacing between colors in a palette,\nand `col_gap` is the vertical spacing between each color palette.\n\nThe following is what the awtools palettes look like using the new plotter.\n\n![](awtools-after.webp)\n\nThe visualization of each palette is different depending on its length.\nWith 3 different behaviors kicking in at the lengths\n\n- 2-12\n- 13-16\n- 17+\n\nI treated the shorter palettes as the main focus here.\nEach color in these palettes will be given a square and the hex code located directly under it.\nThe max width of the image is calculated such that 12 colors fit perfectly across it.\nThis way, you can easily see how long the palette is.\n\nThe slightly longer palettes have been resized such that 16 colors fit perfectly across them.\nThis means that they become rectangles instead of squares,\nbut they also include hexcodes below and the white gap between the colors.\n\nThe remaining long palettes look very much the same as before.\nThey are created such that each color takes up the same width,\ncalculated such that they stretch across the whole width.\n9 hexcodes are shown for roughly evenly spaced colors to provide at least a little context.\n\n![](pals-long.webp)\n\nThe title of each palette is placed above the colors in the middle.\n\nFrom the `size`, `gap`, and `col_gap`, I was able to calculate exactly the height and width of each image being created.\nI could pass this directly into `ggsave()` with `units = \"px\"`.\nTo make the ggplot2 follow these precise instructions I set `theme(plot.margin = margin(0, 0, 0, 0))` to avoid any margins in the plotting,\nand set `expand = c(0, 0)` in both `scale_x_continuous()` and `scale_y_continuous()` such that only the plotting area is saved in the image.\nThis meant that I manually had to add and account for the margin that I was adding myself.\n\n## Reuse Reduce Recycle\n\nNow that we have a way to generate the images, we need to include them in their respective places.\nBefore we look at my new solution, I want to show how we did it before.\n\nThe readme had the following chunks repeated once for each package.\n\n````md\n```{{r cartography, fig.height=17}}\npackage_name <- \"cartography\"\npal_data <- all_names(package_name)\n\nlist_plotter(pal_data$color, pal_data$names, package_name)\n```\n\n```{{r eval=FALSE, echo=TRUE}}\n# Developmental version\ndevtools::install_github(\"riatelab/cartography\")\n# CRAN version\ninstall.packages(\"cartography\")\n```\n````\n\nNote that this was all handcrafted.\nThe CRAN install instructions are only there if the package is on CRAN.\nAnd the `fig-height` is set manually, which is part of the reason why we saw the inconsistency in spacing before.\n\nI did two things that made all of this much easier.\nThe first thing was the decision to pre-generate all the images instead of having them be generated by individual chunks.\nDue to the way I designed {paletteer} and the new plotting function, \nIt became quite trivial:\n\n```r\nsource(\"palette_plotter.R\")\nfs::dir_create(\"palette_images\")\n\npals <- paletteer::palettes_d\n\nwalk2(pals, names(pals), make_plot)\n```\n\nThis means that we basically have the following structure for each package.\n\n````md\n### packagename\n\n``` r\n# Developmental version\npak::pak(\"user/packagename\")\n\n# CRAN version\ninstall.packages(\"packagename\")\n```\n\n![](palette_images/packagename.png)\n````\n\nLuckily, I have all the information needed to generate this markdown in {paletteer} already.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npaletteer::paletteer_packages\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 81 × 5\n   Name             Github                         github_ver CRAN  CRAN_ver\n   <chr>            <chr>                          <chr>      <lgl> <chr>   \n 1 ButterflyColors  junqueiragaabi/ButterflyColors 0.0.0.9000 FALSE <NA>    \n 2 DresdenColor     katiesaund/DresdenColor        0.0.0.9000 FALSE <NA>    \n 3 IslamicArt       lambdamoses/IslamicArt         0.1.0      FALSE <NA>    \n 4 LaCroixColoR     johannesbjork/LaCroixColoR     0.1.0      FALSE <NA>    \n 5 Manu             G-Thomson/Manu                 0.0.2      FALSE <NA>    \n 6 MapPalettes      disarm-platform/MapPalettes    0.0.2      FALSE <NA>    \n 7 MetBrewer        BlakeRMills/MetBrewer          0.3.0      TRUE  0.2.0   \n 8 MexBrewer        paezha/MexBrewer               0.0.2      FALSE 0.0.2   \n 9 MoMAColors       BlakeRMills/MoMAColors         0.0.0.9000 FALSE <NA>    \n10 NatParksPalettes kevinsblake/NatParksPalettes   0.2.0      TRUE  0.2.0   \n# ℹ 71 more rows\n```\n\n\n:::\n:::\n\n\nSo by using the {glue} package, we could use `paletteer_packages` to generate all the markdown we would need.\nUsing a little bit of conditional logic to only print the CRAN instructions if the package is on CRAN,\nand only print the GitHub instructions if the package is on GitHub.\n\nThis is where `#| results: asis` comes in.\nIf I can make a function that returns a print that looks like markdown,\nthen `results: asis` will insert it into the resulting markdown document as is.\nThis means that across the repository, I was able to delete over 1000 lines of repetitive manual markdown and replace them with a single R chunk.\n\nNot only does it cut down on the number of lines I have to write.\nIt means that next time I add more palettes to {paletteer} I just have to rerender these documents and they will appear with no extra work.\n\nIn the readme, all the palettes are showcased.\nBut there are also a couple of other pages, such as [this page with palettes split by type](https://github.com/EmilHvitfeldt/r-color-palettes/blob/main/type-sorted-palettes.md#sequential-color-palettes).\n\nThis was previously also all done by hand,\nand it was more tedious because each package doesn't always have palettes of each type,\nAnd we only want it included in the list if they do.\nWith this new system, I copied the code over,\nThen, I modified it to generate images for each type,\nAnd they used the `asis` code from before with some small modifications.\n\nYou will notice that an additional feature of this system is that each package now has its own section for easier linking, like <https://github.com/EmilHvitfeldt/r-color-palettes#taylorswift>.\n\n## New Non-novelty page\n\nThe vast majority of the palettes in {paletteer} are novelty palettes based on pop culture trends and images.\nWhile fun and exciting, they shouldn't be used for many visualizations as they don't contain good qualities.\n\nWith all the work described earlier, it made it almost trivial for me to add a new page that excludes all these novelty palettes.\n\n<https://github.com/EmilHvitfeldt/r-color-palettes/blob/main/non-novelty.md>\n\n## TOC as children\n\nThis repository is in many ways acting as a makeshift website,\nAnd with that, I had added a makeshift Table of Contents which looks something like this\n\n````md\nTable of Contents\n=================\n  * [Main page](README.md#comprehensive-list-of-color-palettes-in-r)\n  * [Blogposts and other resources](README.md#blogposts-and-other-resources)\n  * [Generative packages](README.md#generative-packages)\n  * [Honorable mentions](README.md#honorable-mentions)\n  * [Palettes sorted by Package (alphabetically)](README.md#palettes-sorted-by-package-alphabetically)\n    * [Non Novelty Palettes](non-novelty.md)\n    * [Sequential color palettes](type-sorted-palettes.md#sequential-color-palettes)\n    * [Diverging color palettes](type-sorted-palettes.md#diverging-color-palettes)\n    * [Qualitative color palettes](type-sorted-palettes.md#qualitative-color-palettes)\n    * [Canva palettes](canva.md)\n    * [Palettetown palettes](palettetown.md)\n  * [News](NEWS.md)\n````\n\nHowever, I had copied this from page to page,\nmade slight modifications in one area, but not in others.\nI fixed this with one of my favorite features in {rmarkdown} with [child documents](https://zsmith27.github.io/rmarkdown_crash-course/lesson-6-child-documents.html)\n\n::: {.callout-note}\nQuarto also has child documents implemented as [includes](https://quarto.org/docs/authoring/includes.html).\n:::\n\nThis lets me add a [single document called toc](https://github.com/EmilHvitfeldt/r-color-palettes/blob/main/toc) that contains the TOC markdown.\nThen, each time I wanted to add a TOC to a page, I just had to add the following chunk to a page.\n\n````md\n```{{r child=\"toc\"}}\n```\n````\n\n## paletteer release\n\nI recently added a number of new packages to {paletteer} and we now have [more palettes supported than ever](https://emilhvitfeldt.github.io/paletteer/news/index.html#paletteer-170).\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}